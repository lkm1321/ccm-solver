function xdot = MGoutputFeedback(~, x, xstar1)

    % xhat = x(1:2); 
    % xtrue = x(3:4); 
    
    x1 = x(3);
    x2 = x(4); 

    xhat1 = x(1);
    xhat2 = x(2); 
    
    y = x2 + 0.2*randn(1); 
    
    feedBackTop = (364.3177*xhat1+35.4547*y+261.2955*xhat1^3+26.3638*xhat1^2+2.9268*xhat1*y-0.0919*y^2+59.3999*xhat1^2*y+4.5435*xhat1*y^2+0.1212*y^3); 
    feedBackBottom = -(364.3177*xhat1+35.4547*xhat2+261.2955*xhat1^3+26.3638*xhat1^2+2.9268*xhat1*xhat2-0.0919*xhat2^2+59.3999*xhat1^2*xhat2+4.5435*xhat1*xhat2^2+0.1212*xhat2^3); 
    
    % For every xstar1, there is a stable xstar2. 
    xstar2 =  -0.5*xstar1^3 - 1.5*xstar1^2;
    
    utop = -(-33.3324*xhat1...
             +10.5770*xhat2...
             -18.9575*xhat1^3 ...
             -2.1281*xhat1^2 ...
             +2.0662*xhat1*x2 ...
             +0.1299*xhat2^2 ...
             +14.8473*xhat1^2*xhat2...
             -3.8578*xhat1*xhat2^2 ...
             +0.3712*xhat2^3); 
       
      ulower = (-33.3324*xstar1...
             +10.5770*xstar2...
             -18.9575*xstar1^3 ...
             -2.1281*xstar1^2 ...
             +2.0662*xstar1*x2 ...
             +0.1299*xstar2^2 ...
             +14.8473*xstar1^2*xstar2...
             -3.8578*xstar1*xstar2^2 ...
             +0.3712*xstar2^3);    
        
    ustar = -xstar1; 
     
    u = utop + ulower + ustar; 

    xhatdot =[-0.5*xhat1^3-1.5*xhat1^2-xhat2 + feedBackTop + feedBackBottom;... 
                xhat1 ]; 

     xtruedot =[-0.5*x1^3-1.5*x1^2-x2;... 
                x1  ]; 
    xdot = [xhatdot; xtruedot]; 
    
end